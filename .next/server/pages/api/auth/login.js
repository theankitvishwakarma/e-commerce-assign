"use strict";(()=>{var e={};e.id=908,e.ids=[908],e.modules={96:e=>{e.exports=require("bcrypt")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},255:(e,r,t)=>{t.r(r),t.d(r,{config:()=>f,default:()=>p,routeModule:()=>_});var n={};t.r(n),t.d(n,{default:()=>handler});var o=t(802),s=t(44),a=t(249),i=t(858),l=t(96),d=t.n(l);let u=require("jsonwebtoken");var c=t.n(u);async function handler(e,r){if("POST"!==e.method)return r.status(405).json({error:"Method not allowed"});try{let{email:t,password:n}=e.body;if(!t||!n)return r.status(400).json({error:"Missing email or password"});let o=await i.Z,s=o.db("deepseek"),a=s.collection("users"),l=await a.findOne({email:t});if(!l)return r.status(401).json({error:"Invalid credentials"});let u=await d().compare(n,l.password);if(!u)return r.status(401).json({error:"Invalid credentials"});let p=c().sign({id:l._id,email:l.email},process.env.JWT_SECRET,{expiresIn:"1d"});r.status(200).json({message:"Login successful",token:p})}catch(e){console.error(e),r.status(500).json({error:"Internal Server Error"})}}let p=(0,a.l)(n,"default"),f=(0,a.l)(n,"config"),_=new o.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/auth/login",pathname:"/api/auth/login",bundlePath:"",filename:""},userland:n})},858:(e,r,t)=>{let n;t.d(r,{Z:()=>a});let o=require("mongodb"),s=process.env.MONGODB_URI;if(!process.env.MONGODB_URI)throw Error("Please add your Mongo URI to .env.local");n=new o.MongoClient(s,{}).connect();let a=n}};var r=require("../../../webpack-api-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[222],()=>__webpack_exec__(255));module.exports=t})();